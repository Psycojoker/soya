-extends "base.haml"

-block javascript
  %script{src: "{{ STATIC_URL }}mediaelementjs/mediaelement-and-player.min.js"}
  %link{rel: "stylesheet", href: "{{ STATIC_URL }}mediaelementjs/mediaelementplayer.min.css"}

  %script{src: "{{ STATIC_URL }}js/plyr.js"}
  %script{src: "{{ STATIC_URL }}js/docs.js"}
  %link{href: "{{ STATIC_URL }}css/plyr.css", rel: "stylesheet"}

  %script{src: "{{ STATIC_URL }}js/video_detail.js"}

  :javascript
    (function(d,p){
        var a=new XMLHttpRequest(),
            b=d.body;
        a.open("GET",p,!0);
        a.send();
        a.onload=function(){
            var c=d.createElement("div");
            c.style.display="none";
            c.innerHTML=a.responseText;
            b.insertBefore(c,b.childNodes[0])
        }
    })(document,"{{ STATIC_URL }}svg/sprite.svg");

    plyr.setup({
      debug: true,
      html: templates.controls.render({}),
    });

  :css
    /* prevent bootstrap from breaking player */
    input[type="range"] {
      width: 100px;
      display: inline-block;
    }

    .player-controls {
      background: #3A3D44;
    }

    .player-progress-played[value] {
      color: #C8C8C8;
    }

    .player-controls button:hover,.player-controls input+label:hover{
      background:#666666;
    }

-block content
  .well{style: "padding: 0; border: 0px"}
    .player
      %video{src: "{{ MEDIA_URL }}videos/{{ object.file_name }}", width: "100%", height: "auto", controls: "controls", type: "video/mp4"}

    %div{ng-app: "soya", ng-controller: "editVideoDetailsController", style: "padding: 20px;"}
      %div{ng-if: "inEditMode == false"}
        %h2{style: "margin-top: 0px", ng-init: 'title="{{ object.title|default:"" }}"'}
          Video: {& title &}

          %a.btn.btn-small.btn-info.pull-right{href: "{{ MEDIA_URL }}videos/{{ object.file_name }}"} Télécharger
        %hr

        .row
          .col-md-6
            %p{ng-init: 'film_name="{{ object.film_name|default:"" }}"'}
              Nom du film: {& film_name &}

            %p{ng-init: 'film_name="{{ object.realisation|default:"" }}"'}
              Realisation: {& realisation &}

          .col-md-6
            %p{ng-init: 'film_name="{{ object.production|default:"" }}"'}
              Production: {& production &}

            %p{ng-init: 'film_name="{{ object.photo_direction|default:"" }}"'}
              Direction photo: {& photo_direction &}

        %i{ng-init: 'film_name="{{ object.observations|default:"" }}"'}
          {& observations &}

  %a{href: "{% url 'administration_video_list' %}"}
    Liste des vidéos

  %h2 Dans les sections
  -for section in video.videosection_set.all
    %p= section
